<!doctype html>
<html lang="en-AU">
  <head>
    <!-- UPDATED: canonical -->
    <link
      rel="canonical"
      href="https://cabanacollections.com.au/products/mens-boxer-brief-black.html"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CABANA Men’s Boxer Brief — Modal Comfort, Anatomical Pouch & U‑Mesh Ventilation</title>
    <meta
      name="description"
      content="CABANA boxer brief pairs modal softness with an anatomical pouch and a discreet U‑mesh cradle for airflow. Cooler, smoother comfort that disappears under clothes."
    />

    <!-- UPDATED: Open Graph (absolute values, one set) -->
    <meta
      property="og:title"
      content="CABANA Men’s Boxer Brief — Modal Comfort, Anatomical Pouch & U‑Mesh"
    />
    <meta
      property="og:description"
      content="Modal softness, anatomical pouch and discreet U‑mesh ventilation for targeted airflow. Minimal look, maximum comfort."
    />
    <meta
      property="og:url"
      content="https://cabanacollections.com.au/products/mens-boxer-brief-black.html"
    />
    <meta
      property="og:image"
      content="https://cabanacollections.com.au/assets/Images/CABANA-BOXERS-FRONT.png"
    />
    <meta property="og:type" content="product" />
    <meta property="product:price:amount" content="50" />
    <meta property="product:price:currency" content="AUD" />

    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Critical CSS -->
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
        background: linear-gradient(135deg, #fafaf8 0%, #f8f6f3 50%, #ffffff 100%);
        overflow-x: hidden;
      }
      .font-heading {
        font-family: 'Playfair Display', serif;
      }
      .text-gold {
        color: #d4af37;
      }
      .tracking-luxury {
        letter-spacing: 0.4em;
      }

      /* Background System */
      .bg-luxury-cream {
        background: linear-gradient(135deg, #fafaf8 0%, #f8f6f3 100%);
      }
      .bg-luxury-white {
        background: linear-gradient(135deg, #ffffff 0%, #fafafa 100%);
      }
      .bg-luxury-charcoal {
        background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
      }

      /* Product Image Gallery */
      .product-gallery {
        position: sticky;
        top: 100px;
      }

      /* Luxury hover effects for product images */
      .product-image {
        position: relative;
        overflow: hidden;
        transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }

      .product-image::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(
          45deg,
          transparent 0%,
          rgba(212, 175, 55, 0.03) 50%,
          transparent 100%
        );
        opacity: 0;
        transition: opacity 0.6s ease;
        z-index: 1;
      }

      .product-image:hover::before {
        opacity: 1;
      }

      .product-image:hover {
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.1);
        transform: translateY(-3px);
      }

      /* Size selector accessibility and luxury styling */
      .size-button {
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        position: relative;
        overflow: hidden;
      }

      .size-button:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .size-button:focus {
        outline: 2px solid #d4af37;
        outline-offset: 2px;
      }

      .size-button::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(45deg, #d4af37, #f4d03f);
        transform: translateX(-100%);
        transition: transform 0.4s ease;
        z-index: -1;
      }

      .size-button:hover::before {
        transform: translateX(0);
      }

      .size-button:hover {
        color: white;
        border-color: #d4af37;
      }

      /* Luxury button animations */
      .luxury-button {
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }

      .luxury-button::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(
          45deg,
          transparent 0%,
          rgba(255, 255, 255, 0.1) 50%,
          transparent 100%
        );
        transform: translateX(-200%);
        transition: transform 0.6s ease;
      }

      .luxury-button:hover::before {
        transform: translateX(200%);
      }

      .luxury-button:active {
        transform: translateY(1px);
      }

      /* Touch-friendly mobile targets */
      @media (max-width: 768px) {
        .size-button {
          min-height: 48px;
          min-width: 48px;
        }
      }

      /* Image zoom on hover/focus */
      .zoomable-image {
        cursor: zoom-in;
        transition: transform 0.3s ease;
      }

      .zoomable-image:hover {
        transform: scale(1.05);
      }

      /* Video styling */
      #mainVideo {
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      #mainVideo:hover {
        transform: scale(1.02);
      }

      /* Video controls styling */
      #videoControls {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
      }

      /* 360° thumbnail styling */
      #360-video-thumbnail:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      /* Loading skeleton */
      .skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
      }

      @keyframes loading {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }

      /* Mobile Conversion Enhancements */
      .mobile-sticky-cta {
        -webkit-backdrop-filter: blur(10px);
        backdrop-filter: blur(10px);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
      }

      .mobile-sticky-cta button:active {
        transform: scale(0.95);
      }

      /* Enhanced Mobile Gallery */
      @media (max-width: 768px) {
        .product-gallery {
          position: relative;
          overflow: hidden;
        }

        .gallery-dots {
          margin-top: 1rem;
        }

        .gallery-dot {
          transition: all 0.2s ease;
        }

        .gallery-dot.active {
          background-color: #000;
          transform: scale(1.2);
        }

        /* Mobile touch enhancements */
        .thumbnail {
          touch-action: manipulation;
        }

        .size-button {
          touch-action: manipulation;
          min-height: 48px;
          min-width: 48px;
        }
      }

      /* Trust signals enhancements */
      .trust-signals {
        animation: slideInFade 0.6s ease-out 0.3s both;
      }

      @keyframes slideInFade {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Progress bar animation */
      @keyframes progressFill {
        from {
          width: 0%;
        }
        to {
          width: 42.5%;
        }
      }

      .mobile-sticky-cta .bg-gradient-to-r {
        animation: progressFill 1s ease-out 0.5s both;
      }

      /* Toast notification */
      .cabana-toast {
        position: fixed;
        left: 50%;
        transform: translateX(-50%);
        bottom: 24px;
        background: #111111;
        color: #ffffff;
        border: 1px solid #2a2a2a;
        padding: 12px 16px;
        border-radius: 8px;
        z-index: 60;
        display: none;
        letter-spacing: 0.05em;
      }
      .cabana-toast.show {
        display: inline-flex;
        animation: toastIn 0.25s ease-out;
      }
      @keyframes toastIn {
        from {
          opacity: 0;
          transform: translate(-50%, 8px);
        }
        to {
          opacity: 1;
          transform: translate(-50%, 0);
        }
      }

      /* Respect reduced motion */
      @media (prefers-reduced-motion: reduce) {
        .luxury-button,
        .size-button,
        .product-image,
        .zoomable-image {
          animation: none !important;
          transition: none !important;
        }
      }
    </style>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- UPDATED: global stylesheet -->
    <link rel="stylesheet" href="/css/styles.css" />
    <!-- Shared UI Enhancements -->
    <script src="/js/ui.js" defer></script>

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Inter:wght@100;200;300;400;500&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />

    <!-- UPDATED: Product Schema (absolute offers.url) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org/",
        "@type": "Product",
        "name": "CABANA Men’s Boxer Brief",
        "image": [
          "https://cabanacollections.com.au/assets/Images/CABANA-BOXERS-FRONT.png",
          "https://cabanacollections.com.au/assets/Images/CABANA-BOXERS-BACK.png",
          "https://cabanacollections.com.au/assets/Images/CABANA-BOXERS-SIDE.png"
        ],
        "description": "Modal-soft boxer brief with anatomical 3D pouch and discreet U-mesh ventilation for targeted airflow. Minimal look, maximum comfort.",
        "brand": {
          "@type": "Brand",
          "name": "CABANA"
        },
        "offers": {
          "@type": "Offer",
          "url": "https://cabanacollections.com.au/products/mens-boxer-brief-black.html",
          "priceCurrency": "AUD",
          "price": "50",
          "availability": "https://schema.org/InStock"
        },
        "material": "95% Modal, 5% Elastane",
        "manufacturer": {
          "@type": "Organization",
          "name": "CABANA"
        }
      }
    </script>
  </head>
  <body
    class="bg-white text-black font-body pt-[env(safe-area-inset-top)] pb-[env(safe-area-inset-bottom)]"
  >
    <script>
      // Permanent redirect to new product URL
      (function () {
        var newUrl = '/products/mens-boxer-brief-black.html';
        if (location.pathname.endsWith('/products/mens-underwear.html')) {
          // Use replace to avoid back button loop
          location.replace(newUrl);
        }
      })();
    </script>
    <!-- Skip Navigation -->
    <a
      href="#product-details"
      class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-black text-white px-4 py-2 z-50"
      >Skip to product details</a
    >

    <!-- Navigation -->
    <nav
      class="fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-sm z-50 border-b border-gray-100 pt-[env(safe-area-inset-top)]"
      role="navigation"
      aria-label="Main navigation"
    >
      <div class="container mx-auto px-6 md:px-12 py-5">
        <div class="flex justify-between items-center">
          <!-- Logo -->
          <a href="/" class="font-heading text-2xl tracking-luxury font-light cabana-logo-nav"
            >CABANA</a
          >

          <!-- Navigation Links -->
          <div class="hidden md:flex items-center space-x-10">
            <a href="/" class="link-hover text-xs tracking-widest font-medium">HOME</a>
            <a
              href="/products/mens-boxer-brief-black.html"
              class="link-hover text-xs tracking-widest font-medium text-gold"
              aria-current="page"
              >MEN</a
            >
            <a
              href="/products/womens-set.html"
              class="link-hover text-xs tracking-widest font-medium"
              >WOMEN</a
            >
            <a href="/about.html" class="link-hover text-xs tracking-widest font-medium">ABOUT</a>
            <a href="/impact.html" class="link-hover text-xs tracking-widest font-medium">IMPACT</a>
            <a href="/contact.html" class="link-hover text-xs tracking-widest font-medium"
              >CONTACT</a
            >
          </div>

          <!-- Actions -->
          <div class="flex items-center space-x-6">
            <!-- Cart Icon -->
            <a href="/cart.html" class="relative group" aria-label="Shopping cart">
              <svg
                class="w-5 h-5 transition-colors duration-300 group-hover:text-gold"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1"
                  d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
                ></path>
              </svg>
              <span
                class="cabana-cart-count absolute -top-2 -right-2 bg-gold text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden"
                aria-live="polite"
                >0</span
              >
            </a>

            <!-- Mobile Menu Button -->
            <button
              class="md:hidden p-2"
              id="mobileMenuBtn"
              aria-label="Toggle menu"
              aria-expanded="false"
            >
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1"
                  d="M4 6h16M4 12h16M4 18h16"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div
        class="md:hidden absolute top-full left-0 right-0 bg-white border-b border-gray-100 transform -translate-y-full transition-transform duration-300"
        id="mobileMenu"
        aria-hidden="true"
      >
        <div class="px-6 py-6 space-y-4">
          <a href="/" class="link-hover block text-sm tracking-wider">HOME</a>
          <a
            href="/products/mens-boxer-brief-black.html"
            class="link-hover block text-sm tracking-wider text-gold"
            >MEN</a
          >
          <a href="/products/womens-set.html" class="link-hover block text-sm tracking-wider"
            >WOMEN</a
          >
          <a href="/about.html" class="link-hover block text-sm tracking-wider">ABOUT</a>
          <a href="/impact.html" class="link-hover block text-sm tracking-wider">IMPACT</a>
          <a href="/contact.html" class="link-hover block text-sm tracking-wider">CONTACT</a>
        </div>
      </div>
    </nav>

    <!-- Breadcrumbs -->
    <nav class="pt-24 px-6 md:px-12" aria-label="Breadcrumb">
      <ol class="flex items-center space-x-2 text-xs text-gray-600">
        <li><a href="../index.html" class="hover:text-gold">Home</a></li>
        <li aria-hidden="true">/</li>
        <li><a href="mens-underwear.html" class="hover:text-gold">Men</a></li>
        <li aria-hidden="true">/</li>
        <li aria-current="page" class="text-black">Essential Boxer Brief</li>
      </ol>
    </nav>

    <!-- Product Section -->
    <!-- Product Section -->
    <main id="product-details" class="py-8 md:py-12 bg-luxury-white">
      <div class="container mx-auto px-6 md:px-12">
        <div class="grid lg:grid-cols-2 gap-8 lg:gap-16 max-w-7xl mx-auto">
          <!-- Image Gallery -->
          <div class="product-gallery space-y-6">
            <!-- Main Image/Video with Zoom -->
            <div class="product-image aspect-[3/4] relative group">
              <img
                id="mainImage"
                src="../assets/Images/CABANA-BOXERS-FRONT.png"
                alt="Front view of CABANA black boxer brief with gold-edge waistband and side-fly"
                class="w-full h-full object-cover zoomable-image"
                tabindex="0"
                aria-describedby="image-zoom-instruction"
              />

              <!-- 360° Video Element -->
              <video
                id="mainVideo"
                class="w-full h-full object-cover zoomable-image hidden"
                muted
                loop
                playsinline
                preload="metadata"
                aria-describedby="video-instruction"
              >
                <source
                  src="../assets/Images/CABANA-BOXERS-360-Desktop.mov"
                  media="(min-width: 768px)"
                />
                <source
                  src="../assets/Images/CABANA-BOXERS-360-Mobile.mov"
                  media="(max-width: 767px)"
                />
                Your browser does not support the video tag.
              </video>

              <span id="image-zoom-instruction" class="sr-only"
                >Click or press Enter to zoom image</span
              >
              <span id="video-instruction" class="sr-only">360° product video</span>

              <!-- Mobile touch indicator -->
              <div
                class="absolute bottom-4 right-4 bg-black/70 text-white px-3 py-1 text-xs rounded md:hidden"
              >
                Pinch to zoom
              </div>

              <!-- Video controls overlay -->
              <div id="videoControls" class="absolute top-4 right-4 hidden">
                <button
                  onclick="toggleVideo()"
                  class="bg-black/70 text-white p-2 rounded-full hover:bg-black/90 transition-colors"
                  aria-label="Play/pause video"
                >
                  <svg
                    id="playIcon"
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                  <svg
                    id="pauseIcon"
                    class="w-4 h-4 hidden"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"
                    ></path>
                  </svg>
                </button>
              </div>
            </div>

            <!-- Thumbnail Images with Better Mobile Layout -->
            <div class="grid grid-cols-5 gap-3">
              <button
                class="thumbnail active border-2 border-black focus:outline-none focus:ring-2 focus:ring-gold"
                onclick="changeImage('../assets/Images/CABANA-BOXERS-FRONT.png', 'Front view of CABANA black boxer brief with gold-edge waistband and side-fly', this)"
                aria-label="View front image"
                aria-pressed="true"
              >
                <img
                  src="../assets/Images/CABANA-BOXERS-FRONT.png"
                  alt="Front view of CABANA black boxer brief with gold-edge waistband and side-fly"
                  class="w-full aspect-square object-cover"
                  loading="lazy"
                />
              </button>
              <button
                class="thumbnail border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-gold"
                onclick="changeImage('../assets/Images/CABANA-BOXERS-BACK.png', 'Back view with gold-edge waistband and CABANA monogram tab', this)"
                aria-label="View back image"
                aria-pressed="false"
              >
                <img
                  src="../assets/Images/CABANA-BOXERS-BACK.png"
                  alt="Back view with gold-edge waistband and CABANA monogram tab"
                  class="w-full aspect-square object-cover"
                  loading="lazy"
                />
              </button>
              <button
                class="thumbnail border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-gold"
                onclick="changeImage('../assets/Images/CABANA-BOXERS-SIDE.png', 'Side profile highlighting pouch contour and breathable mesh', this)"
                aria-label="View side image"
                aria-pressed="false"
              >
                <img
                  src="../assets/Images/CABANA-BOXERS-SIDE.png"
                  alt="Side profile highlighting pouch contour and breathable mesh"
                  class="w-full aspect-square object-cover"
                  loading="lazy"
                />
              </button>
              <button
                class="thumbnail border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-gold"
                onclick="changeImage('../assets/Images/CABANA BOXERS3 flat.png', 'Flat lay highlighting U-mesh cradle and coverstitch seams', this)"
                aria-label="View flat lay image"
                aria-pressed="false"
              >
                <img
                  src="../assets/Images/CABANA BOXERS3 flat.png"
                  alt="Flat lay highlighting U-mesh cradle and coverstitch seams"
                  class="w-full aspect-square object-cover"
                  loading="lazy"
                />
              </button>
              <button
                class="thumbnail border-2 border-gray-200 focus:outline-none focus:ring-2 focus:ring-gold"
                onclick="changeTo360Video()"
                aria-label="View 360° video"
                aria-pressed="false"
                id="360-video-thumbnail"
              >
                <div
                  class="w-full aspect-square bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center relative overflow-hidden rounded"
                >
                  <svg
                    class="w-6 h-6 text-gray-600"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"
                    ></path>
                  </svg>
                  <div
                    class="absolute bottom-1 right-1 bg-gold text-white text-xs px-1 py-0.5 rounded"
                  >
                    360°
                  </div>
                </div>
              </button>
            </div>
          </div>

          <!-- Product Details -->
          <div class="space-y-10 lg:pl-8">
            <!-- Title and Price -->
            <header>
              <h1 class="font-heading text-4xl md:text-5xl font-light mb-4">
                CABANA Men’s Boxer Brief
              </h1>
              <div class="flex items-baseline gap-4 mb-6 flex-wrap">
                <p class="font-heading text-3xl font-light">$50 AUD</p>
                <p class="text-xs tracking-wider text-gray-500">INCLUDING GST</p>
                <a
                  href="#impact-heading"
                  id="impactAnchor"
                  class="ml-auto inline-flex items-center gap-2 text-xs tracking-wider px-3 py-1 rounded-full border border-gray-200 text-gray-700 hover:text-gold hover:border-gold transition-colors duration-200 pill-shimmer"
                >
                  <span>Your Impact</span>
                </a>
              </div>

              <!-- Trust Signals -->
              <div class="trust-signals space-y-3 mb-6">
                <div class="flex items-center gap-2 text-sm text-gray-600">
                  <span class="text-gold text-lg">&#9733;</span>
                  <span class="font-heading text-base text-black"
                    >15% of every purchase supports men’s mental health & women’s empowerment</span
                  >
                </div>
                <div class="flex flex-wrap gap-2 text-xs">
                  <span
                    class="bg-gray-50 text-gray-700 px-2 py-1 rounded-full border border-gray-200"
                    >Free shipping over $200</span
                  >
                  <span
                    class="bg-gray-50 text-gray-700 px-2 py-1 rounded-full border border-gray-200"
                    >30-day guarantee</span
                  >
                </div>
              </div>

              <p class="text-base text-gray-800 mb-4">
                Everyday comfort, engineered. Modal softness, an anatomical 3D pouch, and a discreet
                U‑mesh cradle keep you cooler where it counts—finished with CABANA’s gold‑edge
                waistband.
              </p>

              <!-- Key Features -->
              <div class="space-y-2 mb-6">
                <h3 class="text-xs tracking-widest text-gray-700">KEY FEATURES</h3>
                <ul class="space-y-1 text-sm text-gray-700">
                  <li>• Anatomical 3D pouch for natural lift and fewer readjustments</li>
                  <li>• U‑mesh ventilation under/around the pouch for targeted airflow</li>
                  <li>• Functional side‑fly (left) that stays flat under clothing</li>
                  <li>• Modal-soft stretch (95% modal / 5% elastane) that keeps its shape</li>
                  <li>• Stay‑put leg with clean, cover‑stitched hems</li>
                  <li>• Matte black waistband with double gold piping; rear monogram tab</li>
                  <li>• Purpose built‑in: 15% of every purchase funds impact initiatives</li>
                </ul>
              </div>
            </header>

            <!-- Size Selector with Better Touch Targets -->
            <div role="group" aria-labelledby="size-label">
              <div class="flex justify-between items-baseline mb-4">
                <h3 id="size-label" class="text-xs tracking-widest">SELECT SIZE</h3>
                <button
                  class="hover-link text-xs tracking-wider"
                  onclick="openSizeGuide()"
                  aria-label="Open size guide"
                >
                  SIZE GUIDE
                </button>
              </div>
              <!-- UPDATED: size guide link -->
              <p class="text-xs mb-4">
                <a href="/size-guide.html" class="underline">View full Size Guide</a>
              </p>
              <div class="grid grid-cols-6 gap-2" role="radiogroup" aria-required="true">
                <button
                  class="size-button border border-gray-300 py-4 text-xs font-light relative min-h-[48px]"
                  data-size="XS"
                  role="radio"
                  aria-checked="false"
                  aria-label="Size Extra Small"
                >
                  XS
                </button>
                <button
                  class="size-button border border-gray-300 py-4 text-xs font-light relative min-h-[48px]"
                  data-size="S"
                  role="radio"
                  aria-checked="false"
                  aria-label="Size Small"
                >
                  S
                </button>
                <button
                  class="size-button border border-gray-300 py-4 text-xs font-light relative selected bg-black text-white min-h-[48px]"
                  data-size="M"
                  role="radio"
                  aria-checked="true"
                  aria-label="Size Medium"
                >
                  M
                </button>
                <button
                  class="size-button border border-gray-300 py-4 text-xs font-light relative min-h-[48px]"
                  data-size="L"
                  role="radio"
                  aria-checked="false"
                  aria-label="Size Large"
                >
                  L
                </button>
                <button
                  class="size-button border border-gray-300 py-4 text-xs font-light relative min-h-[48px]"
                  data-size="XL"
                  role="radio"
                  aria-checked="false"
                  aria-label="Size Extra Large"
                >
                  XL
                </button>
                <button
                  class="size-button border border-gray-300 py-4 text-xs font-light relative min-h-[48px]"
                  data-size="2XL"
                  role="radio"
                  aria-checked="false"
                  aria-label="Size Double Extra Large"
                >
                  2XL
                </button>
              </div>
              <div id="size-error" class="text-red-600 text-sm mt-2 hidden" role="alert"></div>
            </div>

            <!-- Bundle Offers -->
            <div class="mb-8">
              <h3 class="text-xs tracking-widest mb-4 text-gray-700">BUNDLE & SAVE</h3>
              <div class="space-y-3">
                <!-- 3-Day Bundle -->
                <div
                  class="bundle-option border border-gray-200 rounded-lg p-4 hover:border-gold hover:scale-[1.02] hover:shadow-lg transition-all duration-300 cursor-pointer"
                  data-bundle="3"
                >
                  <div class="flex justify-between items-center">
                    <div>
                      <div class="font-medium text-sm">3-Day Essential Pack</div>
                      <div class="text-xs text-gray-500">Perfect for a long weekend</div>
                    </div>
                    <div class="text-right">
                      <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-400 line-through">$150</span>
                        <span class="font-heading text-lg font-medium">$135</span>
                      </div>
                      <div class="text-[11px] text-gray-500">≈ $45 per pair</div>
                      <div class="text-xs text-green-600 font-medium">Save $15 • $20.25 Impact</div>
                    </div>
                  </div>
                </div>

                <!-- 5-Day Bundle -->
                <div
                  class="bundle-option border border-gray-200 rounded-lg p-4 hover:border-gold hover:scale-[1.02] hover:shadow-lg transition-all duration-300 cursor-pointer"
                  data-bundle="5"
                >
                  <div class="flex justify-between items-center">
                    <div>
                      <div class="font-medium text-sm">5-Day Work Week</div>
                      <div class="text-xs text-gray-500">Your weekday confidence</div>
                    </div>
                    <div class="text-right">
                      <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-400 line-through">$250</span>
                        <span class="font-heading text-lg font-medium">$200</span>
                      </div>
                      <div class="text-[11px] text-gray-500">≈ $40 per pair</div>
                      <div class="text-xs text-green-600 font-medium">Save $50 • $30 Impact</div>
                    </div>
                  </div>
                </div>

                <!-- 7-Day Bundle -->
                <div
                  class="bundle-option border-2 border-gold bg-gold/5 rounded-lg p-4 cursor-pointer relative"
                  data-bundle="7"
                >
                  <div
                    class="absolute -top-2 left-4 bg-gold text-black text-xs px-2 py-1 rounded-full font-medium"
                  >
                    MOST POPULAR
                  </div>
                  <div class="flex justify-between items-center">
                    <div>
                      <div class="font-medium text-sm">7-Day Complete Week</div>
                      <div class="text-xs text-gray-500">Total comfort, every day</div>
                    </div>
                    <div class="text-right">
                      <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-400 line-through">$350</span>
                        <span class="font-heading text-lg font-medium">$280</span>
                      </div>
                      <div class="text-[11px] text-gray-500">≈ $40 per pair</div>
                      <div class="text-xs text-green-600 font-medium">Save $70 • $42 Impact</div>
                    </div>
                  </div>
                </div>

                <!-- 12-Day Bundle -->
                <div
                  class="bundle-option border border-gray-200 rounded-lg p-4 hover:border-gold hover:scale-[1.02] hover:shadow-lg transition-all duration-300 cursor-pointer relative"
                  data-bundle="12"
                >
                  <div class="flex justify-between items-center">
                    <div>
                      <div class="font-medium text-sm">12-Day Ultimate Pack</div>
                      <div class="text-xs text-gray-500">Maximum value & impact</div>
                    </div>
                    <div class="text-right">
                      <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-400 line-through">$600</span>
                        <span class="font-heading text-lg font-medium">$450</span>
                      </div>
                      <div class="text-[11px] text-gray-500">≈ $37.50 per pair</div>
                      <div class="text-xs text-green-600 font-medium">
                        Save $150 • $67.50 Impact
                      </div>
                    </div>
                  </div>
                  <div
                    class="absolute -top-2 right-4 bg-black text-white text-xs px-2 py-1 rounded-full font-medium"
                  >
                    BEST VALUE
                  </div>
                </div>
              </div>
              <p class="text-xs text-gray-500 mt-3 text-center">
                All bundles include free shipping • Supports mental health initiatives
              </p>
            </div>

            <!-- Add to Cart with Visual Feedback -->
            <div class="space-y-4">
              <button
                class="luxury-button w-full bg-black text-white py-5 text-sm tracking-widest hover:bg-gray-900 hover:scale-[1.02] hover:shadow-xl transition-all duration-300 relative overflow-hidden group"
                id="addToCartBtn"
                aria-label="Add Essential Boxer Brief to cart"
              >
                <span class="button-text transition-transform group-active:scale-95"
                  >ADD TO CART</span
                >
                <span class="loading-text hidden">
                  <span
                    class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"
                  ></span>
                  ADDING...
                </span>
                <span class="success-text hidden">
                  <svg
                    class="inline-block w-5 h-5 mr-2"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 13l4 4L19 7"
                    ></path>
                  </svg>
                  ADDED TO CART
                </span>
              </button>

              <!-- Impact Badge -->
              <div class="text-center py-4 border-y border-gray-100">
                <p class="text-xs tracking-wider font-light">
                  <span class="text-gold">15%</span> OF THIS PURCHASE SUPPORTS MEN’S MENTAL HEALTH &
                  WOMEN’S EMPOWERMENT
                </p>
              </div>

              <p class="text-xs text-center text-gray-500 tracking-wider">
                FREE SHIPPING ON ORDERS OVER $200
              </p>
            </div>

            <!-- Product Details Accordion with Improved Accessibility -->
            <div class="space-y-6 pt-6">
              <details class="group border-b border-gray-100 pb-4">
                <summary
                  class="flex justify-between items-center text-xs tracking-widest cursor-pointer list-none"
                >
                  <span>KEY FEATURES</span>
                  <span class="transform transition-transform duration-300 group-open:rotate-45"
                    >+</span
                  >
                </summary>
                <div class="mt-4 space-y-4 text-sm text-gray-600 font-light">
                  <ul class="space-y-1 ml-4">
                    <li>• Anatomical 3D pouch for natural lift and fewer readjustments</li>
                    <li>• U‑mesh ventilation under/around the pouch for targeted airflow</li>
                    <li>• Functional side‑fly (left) that stays flat under clothing</li>
                    <li>• Modal‑soft stretch (95% modal / 5% elastane) that keeps its shape</li>
                    <li>• Stay‑put leg with clean, cover‑stitched hems</li>
                    <li>• Matte black waistband with double gold piping; rear monogram tab</li>
                    <li>• Purpose built‑in: 15% of every purchase funds impact initiatives</li>
                  </ul>
                </div>
              </details>

              <!-- Materials & Care -->
              <details class="group border-b border-gray-100 pb-4">
                <summary
                  class="flex justify-between items-center text-xs tracking-widest cursor-pointer list-none"
                >
                  <span>MATERIALS & CARE</span>
                  <span class="transform transition-transform duration-300 group-open:rotate-45"
                    >+</span
                  >
                </summary>
                <div class="mt-4 space-y-4 text-sm text-gray-600 font-light">
                  <ul class="space-y-1 ml-4">
                    <li>• Fabric: 95% Modal, 5% Elastane (Spandex)</li>
                    <li>• Ventilation: Discreet U‑shaped micro‑mesh cradle beneath the pouch</li>
                    <li>• Fly: Functional side‑fly (left)</li>
                    <li>• Seams/Hems: Low‑profile coverstitch construction</li>
                    <li>
                      • Waistband: Soft elastic, double gold piping, centred wordmark, rear woven
                      monogram tab
                    </li>
                    <li>• Care: Cold machine wash, line dry; avoid high heat</li>
                  </ul>
                  <p class="text-xs mt-3">
                    <a href="/care-instructions.html" class="underline">Care Instructions</a>
                  </p>
                </div>
              </details>

              <!-- Fit & Sizing -->
              <details class="group border-b border-gray-100 pb-4">
                <summary
                  class="flex justify-between items-center text-xs tracking-widest cursor-pointer list-none"
                >
                  <span>FIT & SIZING</span>
                  <span class="transform transition-transform duration-300 group-open:rotate-45"
                    >+</span
                  >
                </summary>
                <div class="mt-4 space-y-4 text-sm text-gray-600 font-light">
                  <ul class="space-y-1 ml-4">
                    <li>
                      • Intent: Close, supportive, smooth under clothing (boxer brief, mid length)
                    </li>
                    <li>• If between sizes and you prefer a closer fit, size down</li>
                    <li>• Sizes: XS, S, M, L, XL, XXL</li>
                    <li>• Inseam: To be confirmed</li>
                  </ul>
                </div>
              </details>

              <!-- Why It's Different -->
              <details class="group border-b border-gray-100 pb-4">
                <summary
                  class="flex justify-between items-center text-xs tracking-widest cursor-pointer list-none"
                >
                  <span>WHY IT’S DIFFERENT</span>
                  <span class="transform transition-transform duration-300 group-open:rotate-45"
                    >+</span
                  >
                </summary>
                <div class="mt-4 space-y-4 text-sm text-gray-600 font-light">
                  <ul class="space-y-1 ml-4">
                    <li>• Targeted airflow: U‑mesh ventilation right where heat builds most</li>
                    <li>• True anatomical support: 3D pouch lifts without compression</li>
                    <li>• Side‑fly convenience: Functional, flat‑lying opening on the left</li>
                    <li>• Modal‑rich hand feel: Cool, silky, resilient after many washes</li>
                    <li>• Quiet details: Gold‑edge waistband, minimal branding, refined finish</li>
                    <li>
                      • Purpose built‑in: 15% supports men’s mental health & women’s empowerment
                    </li>
                  </ul>
                </div>
              </details>

              <!-- FAQ -->
              <details class="group border-b border-gray-100 pb-4">
                <summary
                  class="flex justify-between items-center text-xs tracking-widest cursor-pointer list-none"
                >
                  <span>FAQ</span>
                  <span class="transform transition-transform duration-300 group-open:rotate-45"
                    >+</span
                  >
                </summary>
                <div class="mt-4 space-y-4 text-sm text-gray-600 font-light">
                  <div>
                    <p class="text-black font-medium mb-1">Is the mesh see‑through?</p>
                    <p>No—designed to be discreet while moving heat and moisture away.</p>
                  </div>
                  <div>
                    <p class="text-black font-medium mb-1">Will it ride up?</p>
                    <p>The leg curve and stretch are tuned to stay put through the day.</p>
                  </div>
                  <div>
                    <p class="text-black font-medium mb-1">How does the pouch feel?</p>
                    <p>Supportive and natural—no flattening, less pressure.</p>
                  </div>
                  <div>
                    <p class="text-black font-medium mb-1">Fly or no fly?</p>
                    <p>Functional side‑fly on the left.</p>
                  </div>
                  <div>
                    <p class="text-black font-medium mb-1">Labels?</p>
                    <p>
                      Recommended: tagless heat‑transfer for zero scratch; rear woven monogram tab
                      remains.
                    </p>
                  </div>
                </div>
              </details>
            </div>
          </div>
        </div>
      </div>
      <!-- Live Impact Calculator: moved directly below product gallery -->
      <section class="pt-8 md:pt-12 relative overflow-hidden" aria-labelledby="impact-heading">
        <div class="hairline-dark mb-8" aria-hidden="true"></div>
        <div class="max-w-6xl mx-auto px-6 md:px-12 relative">
          <!-- Section Header -->
          <div class="text-center mb-10 md:mb-12">
            <h2
              id="impact-heading"
              class="font-heading text-3xl md:text-4xl font-light mb-6 text-gray-900"
            >
              Redefining Purpose Through Craft
            </h2>
            <div
              class="w-20 h-px bg-gradient-to-r from-transparent via-gold to-transparent mx-auto mb-6"
              aria-hidden="true"
            ></div>
            <p class="text-gray-600 max-w-3xl mx-auto text-lg font-light leading-relaxed">
              True refinement isn't just about what you wear—it's about the impact you create. See
              exactly how your CABANA purchase supports mental health initiatives through our
              verified partnerships with Australia's leading wellbeing organisations.
            </p>
          </div>

          <!-- Interactive Calculator -->
          <div class="bg-white rounded-2xl shadow-2xl p-8 md:p-12 border border-gray-100">
            <!-- Quantity Selector -->
            <div class="text-center mb-12">
              <h3 class="text-xl font-heading mb-6 text-gray-900">Calculate Your Real Impact</h3>
              <div class="flex items-center justify-center gap-4 mb-8">
                <button
                  id="decreaseQty"
                  class="w-12 h-12 rounded-full border-2 border-gray-300 flex items-center justify-center hover:border-gold hover:text-gold hover:scale-110 hover:shadow-lg transition-all duration-300"
                  aria-label="Decrease quantity"
                >
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M20 12H4"
                    ></path>
                  </svg>
                </button>
                <div class="text-center mx-8">
                  <div class="text-5xl font-heading font-light mb-2 text-gray-900" id="currentQty">
                    1
                  </div>
                  <div class="text-sm text-gray-500 uppercase tracking-wider">Items</div>
                </div>
                <button
                  id="increaseQty"
                  class="w-12 h-12 rounded-full border-2 border-gray-300 flex items-center justify-center hover:border-gold hover:text-gold hover:scale-110 hover:shadow-lg transition-all duration-300"
                  aria-label="Increase quantity"
                >
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 4v16m8-8H4"
                    ></path>
                  </svg>
                </button>
              </div>

              <!-- Investment Display -->
              <div class="bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl p-6 mb-8">
                <div class="flex justify-between items-center text-lg mb-3">
                  <span class="text-gray-700 font-medium">Your Investment:</span>
                  <span class="font-heading text-2xl text-gray-900" id="totalPrice">$50 AUD</span>
                </div>
                <div class="flex justify-between items-center text-lg">
                  <span class="text-gray-700 font-medium">Mental Health Contribution (15%):</span>
                  <span class="font-heading text-2xl text-gold font-medium" id="donationAmount"
                    >$7.50 AUD</span
                  >
                </div>
              </div>
            </div>

            <!-- Impact Visualization -->
            <div class="grid md:grid-cols-1 gap-8 mb-12">
              <div
                class="impact-card bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-8 border border-gray-200 hover:shadow-lg transition-shadow duration-300"
              >
                <div class="flex items-center mb-6">
                  <div
                    class="w-14 h-14 bg-gradient-to-r from-gray-800 to-gray-700 rounded-xl flex items-center justify-center mr-4 shadow-md"
                  >
                    <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 20 20">
                      <path
                        fill-rule="evenodd"
                        d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                        clip-rule="evenodd"
                      ></path>
                    </svg>
                  </div>
                  <div>
                    <h4 class="text-xl font-heading text-gray-900 mb-1">Men's Mental Health</h4>
                    <p class="text-gray-700 text-sm">Beyond Blue & MensLine Australia</p>
                  </div>
                </div>
                <div class="space-y-4 mb-6">
                  <div class="flex justify-between items-center">
                    <span class="text-gray-700">Crisis support resources:</span
                    ><span class="font-bold text-gray-900 text-lg" id="menSupport">8 people</span>
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-gray-700">Educational materials:</span
                    ><span class="font-bold text-gray-900 text-lg" id="menEducation"
                      >3 packages</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-gray-700">Digital resources accessed:</span
                    ><span class="font-bold text-gray-900 text-lg" id="menDigital"
                      >12 sessions</span
                    >
                  </div>
                  <div class="flex justify-between items-center">
                    <span class="text-gray-700">Mental health awareness:</span
                    ><span class="font-bold text-gray-900 text-lg" id="menAwareness"
                      >25 people</span
                    >
                  </div>
                </div>
                <div class="bg-gray-200/70 rounded-lg p-4">
                  <p class="text-sm text-gray-900 italic font-medium leading-relaxed">
                    "Every dollar funds immediate crisis support and long-term preventive programs
                    for men facing mental health challenges."
                  </p>
                </div>
              </div>
            </div>

            <!-- Sustainability Impact -->
            <div
              class="bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-8 mb-8 border border-gray-200"
            >
              <div class="text-center mb-6">
                <h4 class="text-2xl font-heading text-gray-900 mb-4">
                  Environmental Impact Per Item
                </h4>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                  <div class="text-center">
                    <div class="text-3xl mb-2">💧</div>
                    <div class="text-2xl font-bold text-gold">-95%</div>
                    <div class="text-xs text-gray-600 uppercase tracking-wider">
                      Water Usage vs Cotton
                    </div>
                  </div>
                  <div class="text-center">
                    <div class="text-3xl mb-2">🌱</div>
                    <div class="text-2xl font-bold text-gold">100%</div>
                    <div class="text-xs text-gray-600 uppercase tracking-wider">Biodegradable</div>
                  </div>
                  <div class="text-center">
                    <div class="text-3xl mb-2">♻️</div>
                    <div class="text-2xl font-bold text-gold">0</div>
                    <div class="text-xs text-gray-600 uppercase tracking-wider">
                      Waste to Landfill
                    </div>
                  </div>
                  <div class="text-center">
                    <div class="text-3xl mb-2">🌳</div>
                    <div class="text-2xl font-bold text-gold">1</div>
                    <div class="text-xs text-gray-600 uppercase tracking-wider">
                      Tree Equivalent CO₂
                    </div>
                  </div>
                </div>
              </div>
              <div class="text-center">
                <p class="text-gray-800 font-medium text-sm leading-relaxed max-w-3xl mx-auto">
                  Our modal fabric comes from sustainably managed beech forests. When your CABANA
                  piece reaches end-of-life, it returns completely to nature—no microplastics, no
                  synthetic waste, just earth back to earth.
                </p>
              </div>
            </div>

            <!-- Combined Impact Summary -->
            <div
              class="bg-gradient-to-b from-neutral-900 via-black to-neutral-900 text-white rounded-xl p-8 border border-neutral-800"
            >
              <div class="text-center mb-6">
                <h4 class="text-2xl font-heading text-white/90 mb-2">Total Lives Impacted</h4>
                <div class="text-6xl font-heading font-light text-gold mb-2" id="totalLives">
                  70
                </div>
                <p class="text-slate-300 font-medium">
                  People directly supported by your conscious choice
                </p>
              </div>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                <div>
                  <div class="text-2xl font-bold text-white" id="totalSupport">8</div>
                  <div class="text-xs text-slate-400 uppercase tracking-wider">Crisis Support</div>
                </div>
                <div>
                  <div class="text-2xl font-bold text-white" id="totalEducation">5</div>
                  <div class="text-xs text-slate-400 uppercase tracking-wider">
                    Education Programs
                  </div>
                </div>
                <div>
                  <div class="text-2xl font-bold text-white" id="totalResources">13</div>
                  <div class="text-xs text-slate-400 uppercase tracking-wider">Resource Access</div>
                </div>
                <div>
                  <div class="text-2xl font-bold text-white" id="totalAwareness">55</div>
                  <div class="text-xs text-slate-400 uppercase tracking-wider">Awareness Reach</div>
                </div>
              </div>
            </div>

            <!-- Partnership Transparency -->
            <div class="mt-12 text-center">
              <h5 class="text-lg font-heading mb-6 text-gray-900">Verified Impact Partners</h5>
              <div
                class="flex flex-col sm:flex-row items-center justify-center gap-8 text-sm text-gray-600 mb-6"
              >
                <div class="flex items-center gap-3">
                  <div
                    class="w-10 h-10 bg-gradient-to-r from-gray-800 to-gray-700 rounded-full flex items-center justify-center shadow-md"
                  >
                    <span class="text-white font-bold text-xs">BB</span>
                  </div>
                  <div class="text-left">
                    <div class="font-medium text-gray-900">Beyond Blue</div>
                    <div class="text-xs text-gray-500">
                      24/7 Crisis Support • Men's Mental Health
                    </div>
                  </div>
                </div>
              </div>
              <p class="text-xs text-gray-500 max-w-3xl mx-auto leading-relaxed">
                Impact calculations based on verified program costs from our mental health partners.
                All contributions are tracked and reported quarterly. Partnership agreements ensure
                100% of designated funds reach frontline services.
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Size Guide Modal -->
    <div
      id="sizeGuideModal"
      class="fixed inset-0 bg-black/50 z-50 hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="size-guide-title"
    >
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white max-w-2xl w-full p-8 relative">
          <button
            onclick="closeSizeGuide()"
            class="absolute top-4 right-4 text-gray-600 hover:text-black"
            aria-label="Close size guide"
          >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>

          <h2 id="size-guide-title" class="font-heading text-2xl mb-6">
            CABANA Men's Collection Underwear Size Chart
          </h2>

          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-gray-300">
                  <th class="text-left py-3 font-medium">Size</th>
                  <th class="text-left py-3 font-medium">Waist (inches)</th>
                  <th class="text-left py-3 font-medium">Waist (cm)</th>
                  <th class="text-left py-3 font-medium">Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-b border-gray-200">
                  <td class="py-3 font-medium">2XS</td>
                  <td class="py-3">24–26″</td>
                  <td class="py-3">61–66 cm</td>
                  <td class="py-3 text-gray-600">For very slim builds or younger fit</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-3 font-medium">XS</td>
                  <td class="py-3">26–28″</td>
                  <td class="py-3">66–71 cm</td>
                  <td class="py-3 text-gray-600">Snug fit with light compression</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-3 font-medium">S</td>
                  <td class="py-3">28–30″</td>
                  <td class="py-3">71–76 cm</td>
                  <td class="py-3 text-gray-600">Tailored for lean frames</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-3 font-medium">M</td>
                  <td class="py-3">30–32″</td>
                  <td class="py-3">76–81 cm</td>
                  <td class="py-3 text-gray-600">True-to-size for most</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-3 font-medium">L</td>
                  <td class="py-3">32–34″</td>
                  <td class="py-3">81–86 cm</td>
                  <td class="py-3 text-gray-600">Sculpted fit with room</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-3 font-medium">XL</td>
                  <td class="py-3">34–36″</td>
                  <td class="py-3">86–91 cm</td>
                  <td class="py-3 text-gray-600">Designed for comfort and support</td>
                </tr>
                <tr>
                  <td class="py-3 font-medium">2XL</td>
                  <td class="py-3">36–38″</td>
                  <td class="py-3">91–97 cm</td>
                  <td class="py-3 text-gray-600">Expansive, without sagging</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="mt-8 space-y-4">
            <div class="border-t border-gray-200 pt-6">
              <h3 class="text-sm font-medium text-black mb-3">✅ Fit Guidance</h3>
              <div class="space-y-2 text-sm text-gray-600">
                <p>
                  <strong>Fabric stretch:</strong> Modal-Spandex blend provides a body-contouring
                  fit with comfort retention.
                </p>
                <p><strong>Prefer a looser feel?</strong> Size up.</p>
                <p>
                  <strong>In-between sizes?</strong> Choose based on your fit preference — tighter
                  (size down), relaxed (size up).
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Optimised JavaScript -->
    <script>
      // Toast helper
      function showToast(message, ms = 1800) {
        let t = document.getElementById('toast');
        if (!t) {
          t = document.createElement('div');
          t.id = 'toast';
          t.className = 'cabana-toast';
          document.body.appendChild(t);
        }
        t.textContent = message;
        t.classList.add('show');
        setTimeout(() => t.classList.remove('show'), ms);
      }
      // Enhanced Image Gallery with Mobile Swipe
      class ProductGallery {
        constructor() {
          this.images = [
            { src: '../assets/Images/CABANA-BOXERS-FRONT.png', alt: 'Front view' },
            { src: '../assets/Images/CABANA-BOXERS-BACK.png', alt: 'Back view' },
            { src: '../assets/Images/CABANA-BOXERS-SIDE.png', alt: 'Side view' },
            { src: '../assets/Images/CABANA BOXERS3 flat.png', alt: 'Flat lay view' },
          ];
          this.currentIndex = 0;
          this.mainImage = document.getElementById('mainImage');
          this.thumbnails = document.querySelectorAll('.thumbnail');

          this.initializeSwipeGestures();
          this.addMobileDots();
        }

        changeImage(src, altText, thumbnail) {
          // Switch back to image from video if needed
          const mainVideo = document.getElementById('mainVideo');
          const videoControls = document.getElementById('videoControls');

          if (mainVideo && !mainVideo.classList.contains('hidden')) {
            mainVideo.classList.add('hidden');
            mainVideo.pause();
            if (videoControls) {
              videoControls.classList.add('hidden');
            }
          }

          this.mainImage.classList.remove('hidden');
          this.mainImage.src = src;
          this.mainImage.alt = `CABANA Men’s Boxer Brief - ${altText}`;

          // Update thumbnail states
          this.thumbnails.forEach((thumb) => {
            thumb.classList.remove('active', 'border-black');
            thumb.classList.add('border-gray-200');
            thumb.setAttribute('aria-pressed', 'false');
          });

          if (thumbnail) {
            thumbnail.classList.add('active', 'border-black');
            thumbnail.classList.remove('border-gray-200');
            thumbnail.setAttribute('aria-pressed', 'true');
          }

          // Update current index
          this.currentIndex = this.images.findIndex((img) => img.src === src);
          this.updateDots();

          // Track gallery interaction
          if (typeof gtag !== 'undefined') {
            gtag('event', 'product_gallery_view', {
              image_name: altText,
              image_index: this.currentIndex,
            });
          }
        }

        initializeSwipeGestures() {
          if (window.innerWidth > 768) return; // Desktop only

          let startX = 0;
          let startY = 0;
          let endX = 0;
          let endY = 0;

          const gallery = document.querySelector('.product-gallery');

          gallery.addEventListener(
            'touchstart',
            (e) => {
              startX = e.touches[0].clientX;
              startY = e.touches[0].clientY;
            },
            { passive: false }
          );

          gallery.addEventListener(
            'touchmove',
            (e) => {
              // Prevent scrolling while swiping horizontally
              const deltaX = Math.abs(e.touches[0].clientX - startX);
              const deltaY = Math.abs(e.touches[0].clientY - startY);

              if (deltaX > deltaY) {
                e.preventDefault();
              }
            },
            { passive: false }
          );

          gallery.addEventListener(
            'touchend',
            (e) => {
              endX = e.changedTouches[0].clientX;
              endY = e.changedTouches[0].clientY;

              const deltaX = endX - startX;
              const deltaY = endY - startY;

              // Only trigger if horizontal swipe is dominant and significant
              if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                if (deltaX > 0) {
                  this.previousImage();
                } else {
                  this.nextImage();
                }
              }
            },
            { passive: false }
          );
        }

        nextImage() {
          this.currentIndex = (this.currentIndex + 1) % this.images.length;
          this.updateGallery();
        }

        previousImage() {
          this.currentIndex =
            this.currentIndex === 0 ? this.images.length - 1 : this.currentIndex - 1;
          this.updateGallery();
        }

        updateGallery() {
          // If the 360° video is active, hide and pause it when switching via swipe/dots
          const mainVideo = document.getElementById('mainVideo');
          const videoControls = document.getElementById('videoControls');
          if (mainVideo && !mainVideo.classList.contains('hidden')) {
            mainVideo.pause();
            mainVideo.classList.add('hidden');
            if (videoControls) {
              videoControls.classList.add('hidden');
            }
          }

          // Ensure the image is visible and updated
          this.mainImage.classList.remove('hidden');
          const currentImage = this.images[this.currentIndex];
          this.mainImage.src = currentImage.src;
          this.mainImage.alt = `CABANA Men’s Boxer Brief - ${currentImage.alt}`;

          // Update thumbnails
          this.thumbnails.forEach((thumb, index) => {
            thumb.classList.remove('active', 'border-black');
            thumb.classList.add('border-gray-200');
            thumb.setAttribute('aria-pressed', 'false');

            if (index === this.currentIndex) {
              thumb.classList.add('active', 'border-black');
              thumb.classList.remove('border-gray-200');
              thumb.setAttribute('aria-pressed', 'true');
            }
          });

          this.updateDots();

          // Track swipe interaction
          if (typeof gtag !== 'undefined') {
            gtag('event', 'product_gallery_swipe', {
              image_index: this.currentIndex,
              image_name: currentImage.alt,
            });
          }
        }

        addMobileDots() {
          if (window.innerWidth > 768) return;

          const gallery = document.querySelector('.product-gallery');
          const dotsContainer = document.createElement('div');
          dotsContainer.className = 'gallery-dots flex justify-center mt-4 space-x-2';

          this.images.forEach((_, index) => {
            const dot = document.createElement('button');
            dot.className = `gallery-dot w-2 h-2 rounded-full transition-all duration-200 ${
              index === 0 ? 'bg-black scale-125' : 'bg-gray-300'
            }`;
            dot.setAttribute('aria-label', `View image ${index + 1}`);

            dot.addEventListener('click', () => {
              this.currentIndex = index;
              this.updateGallery();
            });

            dotsContainer.appendChild(dot);
          });

          gallery.appendChild(dotsContainer);
        }

        updateDots() {
          const dots = document.querySelectorAll('.gallery-dot');
          dots.forEach((dot, index) => {
            dot.classList.remove('bg-black', 'scale-125');
            dot.classList.add('bg-gray-300');

            if (index === this.currentIndex) {
              dot.classList.add('bg-black', 'scale-125');
              dot.classList.remove('bg-gray-300');
            }
          });
        }
      }

      // Initialize gallery
      const productGallery = new ProductGallery();

      // Legacy function for backward compatibility
      function changeImage(src, altText, thumbnail) {
        productGallery.changeImage(src, altText, thumbnail);
      }

      // 360° Video Functions
      function changeTo360Video() {
        const mainImage = document.getElementById('mainImage');
        const mainVideo = document.getElementById('mainVideo');
        const videoControls = document.getElementById('videoControls');
        const videoThumbnail = document.getElementById('360-video-thumbnail');

        // Hide image and show video
        mainImage.classList.add('hidden');
        mainVideo.classList.remove('hidden');
        videoControls.classList.remove('hidden');

        // Update thumbnail states
        document.querySelectorAll('.thumbnail').forEach((thumb) => {
          thumb.classList.remove('active', 'border-black');
          thumb.classList.add('border-gray-200');
          thumb.setAttribute('aria-pressed', 'false');
        });

        videoThumbnail.classList.add('active', 'border-black');
        videoThumbnail.classList.remove('border-gray-200');
        videoThumbnail.setAttribute('aria-pressed', 'true');

        // Start video
        mainVideo.play().catch((e) => {
          console.log('Video autoplay prevented:', e);
        });

        // Track video view
        if (typeof gtag !== 'undefined') {
          gtag('event', 'product_360_video_view', {
            product_name: 'Essential Boxer Brief',
            video_type: '360_degree',
          });
        }
      }

      // Track impact anchor clicks
      (function () {
        document.addEventListener('DOMContentLoaded', function () {
          const impactAnchor = document.getElementById('impactAnchor');
          const impactAnchorMobile = document.getElementById('impactAnchorMobile');
          if (impactAnchor) {
            impactAnchor.addEventListener('click', function () {
              if (typeof gtag !== 'undefined') {
                gtag('event', 'impact_anchor_click', { position: 'product_header' });
              }
            });
          }
          if (impactAnchorMobile) {
            impactAnchorMobile.addEventListener('click', function () {
              if (typeof gtag !== 'undefined') {
                gtag('event', 'impact_anchor_click', { position: 'mobile_sticky' });
              }
            });
          }
        });
      })();

      function toggleVideo() {
        const video = document.getElementById('mainVideo');
        const playIcon = document.getElementById('playIcon');
        const pauseIcon = document.getElementById('pauseIcon');

        if (video.paused) {
          video.play();
          playIcon.classList.add('hidden');
          pauseIcon.classList.remove('hidden');
        } else {
          video.pause();
          pauseIcon.classList.add('hidden');
          playIcon.classList.remove('hidden');
        }
      }

      // Handle video click to toggle play/pause
      document.addEventListener('DOMContentLoaded', function () {
        const mainVideo = document.getElementById('mainVideo');
        if (mainVideo) {
          mainVideo.addEventListener('click', toggleVideo);

          // Pause video when offscreen (Firefox-friendly playsinline fallback)
          if ('IntersectionObserver' in window) {
            const observer = new IntersectionObserver(
              (entries) => {
                entries.forEach((entry) => {
                  if (!entry.isIntersecting && !mainVideo.paused) {
                    try {
                      mainVideo.pause();
                    } catch (_) {}
                  }
                });
              },
              { threshold: 0.1 }
            );
            observer.observe(mainVideo);
          }
        }
      });

      // Size Selection with Validation
      const sizeButtons = document.querySelectorAll('.size-button');
      let selectedSize = 'M';

      sizeButtons.forEach((button) => {
        button.addEventListener('click', () => {
          // Update visual state
          sizeButtons.forEach((btn) => {
            btn.classList.remove('selected', 'bg-black', 'text-white');
            btn.setAttribute('aria-checked', 'false');
          });

          button.classList.add('selected', 'bg-black', 'text-white');
          button.setAttribute('aria-checked', 'true');
          selectedSize = button.dataset.size;

          // Clear any error message
          document.getElementById('size-error').classList.add('hidden');
        });

        // Keyboard navigation
        button.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            button.click();
          }
        });
      });

      // Enhanced Add to Cart
      const addToCartBtn = document.getElementById('addToCartBtn');
      const buttonText = addToCartBtn.querySelector('.button-text');
      const loadingText = addToCartBtn.querySelector('.loading-text');
      const successText = addToCartBtn.querySelector('.success-text');

      addToCartBtn.addEventListener('click', () => {
        if (!selectedSize) {
          const errorEl = document.getElementById('size-error');
          errorEl.textContent = 'Please select a size';
          errorEl.classList.remove('hidden');
          return;
        }

        // Show loading state
        addToCartBtn.disabled = true;
        buttonText.classList.add('hidden');
        loadingText.classList.remove('hidden');

        // Simulate API call
        setTimeout(() => {
          try {
            // Get current cart
            let cart = JSON.parse(localStorage.getItem('cabanaCart') || '[]');

            // Check if item already exists
            const existingItem = cart.find(
              (item) => item.id === 'mens-underwear' && item.size === selectedSize
            );

            if (existingItem) {
              existingItem.quantity += 1;
            } else {
              cart.push({
                id: 'mens-underwear',
                name: 'Essential Boxer Brief',
                price: 50,
                size: selectedSize,
                quantity: 1,
                image: '/assets/Images/CABANA-BOXERS-FRONT.png',
              });
            }

            // Save cart
            localStorage.setItem('cabanaCart', JSON.stringify(cart));

            // Update cart count
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            localStorage.setItem('cabanaCartCount', totalItems);
            updateCartCount();

            // Show success state
            loadingText.classList.add('hidden');
            successText.classList.remove('hidden');
            showToast('Added to cart');

            // Reset after delay
            setTimeout(() => {
              addToCartBtn.disabled = false;
              successText.classList.add('hidden');
              buttonText.classList.remove('hidden');
            }, 2000);
          } catch (error) {
            console.error('Error adding to cart:', error);
            // Show error state
            loadingText.classList.add('hidden');
            buttonText.classList.remove('hidden');
            buttonText.textContent = 'ERROR - TRY AGAIN';
            addToCartBtn.disabled = false;

            setTimeout(() => {
              buttonText.textContent = 'ADD TO CART';
            }, 2000);
          }
        }, 800);
      });

      // Size Guide Modal
      function openSizeGuide() {
        const modal = document.getElementById('sizeGuideModal');
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';

        // Focus management
        modal.querySelector('button').focus();
      }

      function closeSizeGuide() {
        const modal = document.getElementById('sizeGuideModal');
        modal.classList.add('hidden');
        document.body.style.overflow = '';

        // Return focus to size guide button
        document.querySelector('[aria-label="Open size guide"]').focus();
      }

      // ESC key to close modal
      document.addEventListener('keydown', (e) => {
        if (
          e.key === 'Escape' &&
          !document.getElementById('sizeGuideModal').classList.contains('hidden')
        ) {
          closeSizeGuide();
        }
      });

      // Mobile Menu
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');

      mobileMenuBtn.addEventListener('click', () => {
        const isOpen = mobileMenu.classList.contains('translate-y-0');

        if (isOpen) {
          mobileMenu.classList.remove('translate-y-0');
          mobileMenu.classList.add('-translate-y-full');
          mobileMenuBtn.setAttribute('aria-expanded', 'false');
          mobileMenu.setAttribute('aria-hidden', 'true');
        } else {
          mobileMenu.classList.add('translate-y-0');
          mobileMenu.classList.remove('-translate-y-full');
          mobileMenuBtn.setAttribute('aria-expanded', 'true');
          mobileMenu.setAttribute('aria-hidden', 'false');
        }
      });

      // Cart Count
      function updateCartCount() {
        try {
          const cartCount = localStorage.getItem('cabanaCartCount') || 0;
          const cartCountElements = document.querySelectorAll('.cabana-cart-count');

          cartCountElements.forEach((el) => {
            if (cartCount > 0) {
              el.textContent = cartCount;
              el.classList.remove('hidden');
            } else {
              el.classList.add('hidden');
            }
          });
        } catch (error) {
          console.error('Error updating cart count:', error);
        }
      }

      // Image Zoom (Desktop)
      const mainImage = document.getElementById('mainImage');
      if (window.innerWidth > 768) {
        mainImage.addEventListener('click', function () {
          // Simple zoom implementation
          this.classList.toggle('scale-150');
        });
      }

      // Removed FOMO/urgency elements per brand guidelines

      // Mobile Sticky Bar Controller
      function initializeMobileStickyBar() {
        const stickyBar = document.getElementById('mobileStickyBar');
        const mobileAddToCart = document.getElementById('mobileAddToCart');
        const mobileSelectedSize = document.getElementById('mobileSelectedSize');
        let isVisible = false;

        // Show/hide based on scroll position
        function updateStickyBarVisibility() {
          const scrollY = window.scrollY;
          const productSection = document.getElementById('product-details');
          const shouldShow = scrollY > 300; // Show after scrolling 300px

          if (shouldShow && !isVisible) {
            stickyBar.classList.remove('translate-y-full');
            stickyBar.classList.add('translate-y-0');
            isVisible = true;
          } else if (!shouldShow && isVisible) {
            stickyBar.classList.add('translate-y-full');
            stickyBar.classList.remove('translate-y-0');
            isVisible = false;
          }
        }

        // Update size display when size is selected
        sizeButtons.forEach((button) => {
          button.addEventListener('click', () => {
            mobileSelectedSize.textContent = button.dataset.size;
          });
        });

        // Mobile add to cart functionality
        mobileAddToCart.addEventListener('click', () => {
          // Trigger the main add to cart function
          document.getElementById('addToCartBtn').click();

          // Show loading state
          const buttonText = mobileAddToCart.querySelector('.mobile-button-text');
          const loadingText = mobileAddToCart.querySelector('.mobile-loading-text');

          mobileAddToCart.disabled = true;
          buttonText.classList.add('hidden');
          loadingText.classList.remove('hidden');

          // Reset after delay
          setTimeout(() => {
            mobileAddToCart.disabled = false;
            buttonText.classList.remove('hidden');
            loadingText.classList.add('hidden');
          }, 2000);
        });

        // Throttled scroll listener
        let ticking = false;
        window.addEventListener('scroll', () => {
          if (!ticking) {
            requestAnimationFrame(() => {
              updateStickyBarVisibility();
              ticking = false;
            });
            ticking = true;
          }
        });
      }

      // Enhanced Trust Signals
      function initializeTrustSignals() {
        // Dynamic viewer count
        function updateViewerCount() {
          const viewerCountEl = document.getElementById('viewerCount');
          if (viewerCountEl) {
            const baseCount = 15;
            const variation = Math.floor(Math.random() * 20) + 1;
            const currentCount = baseCount + variation;
            viewerCountEl.textContent = `${currentCount} people`;
          }
        }

        // Update viewer count every 30-60 seconds
        updateViewerCount();
        setInterval(updateViewerCount, Math.random() * 30000 + 30000);
      }

      // Email validation helper
      function validateNewsletterEmail(email) {
        const re =
          /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email.toLowerCase());
      }

      // Initialize
      updateCartCount();
      // FOMO elements removed

      // Initialize mobile features only on mobile
      if (window.innerWidth <= 768) {
        initializeMobileStickyBar();
      }

      // Initialize trust signals after page load
      setTimeout(() => {
        initializeTrustSignals();
      }, 2000);

      // Research-Based Impact Calculator for CABANA
      // Based on verified data from Beyond Blue and Lifeline Australia
      class ResearchBasedImpactCalculator {
        constructor() {
          this.quantity = 1;
          this.pricePerItem = 50;
          this.donationPercentage = 0.15;

          // Research-based cost structures (AUD)
          // Data sources: Lifeline Annual Report 2023-24, Beyond Blue program data, WHV initiatives
          this.costStructure = {
            // Men's Mental Health
            // Beyond Blue/MensLine: ~$55 per crisis call, lower costs for digital resources
            mensHealth: {
              crisisSupport: 0.95, // $0.95 per person supported (digital resources)
              educationalMaterials: 2.55, // $2.55 per educational package
              digitalResources: 0.64, // $0.64 per digital session access
              awarenessOutreach: 0.31, // $0.31 per person reached
            },
          };

          this.initializeElements();
          this.attachEventListeners();
          this.updateCalculations();
        }

        initializeElements() {
          // Control elements
          this.decreaseBtn = document.getElementById('decreaseQty');
          this.increaseBtn = document.getElementById('increaseQty');
          this.currentQtyEl = document.getElementById('currentQty');
          this.totalPriceEl = document.getElementById('totalPrice');
          this.donationAmountEl = document.getElementById('donationAmount');

          // Men's impact elements
          this.menSupportEl = document.getElementById('menSupport');
          this.menEducationEl = document.getElementById('menEducation');
          this.menDigitalEl = document.getElementById('menDigital');
          this.menAwarenessEl = document.getElementById('menAwareness');

          // Summary elements
          this.totalLivesEl = document.getElementById('totalLives');
          this.totalSupportEl = document.getElementById('totalSupport');
          this.totalEducationEl = document.getElementById('totalEducation');
          this.totalResourcesEl = document.getElementById('totalResources');
          this.totalAwarenessEl = document.getElementById('totalAwareness');
        }

        attachEventListeners() {
          if (this.decreaseBtn) {
            this.decreaseBtn.addEventListener('click', () => this.changeQuantity(-1));
          }
          if (this.increaseBtn) {
            this.increaseBtn.addEventListener('click', () => this.changeQuantity(1));
          }

          // Keyboard navigation
          if (this.decreaseBtn) {
            this.decreaseBtn.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                this.changeQuantity(-1);
              }
            });
          }

          if (this.increaseBtn) {
            this.increaseBtn.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                this.changeQuantity(1);
              }
            });
          }
        }

        changeQuantity(delta) {
          const newQuantity = this.quantity + delta;
          if (newQuantity >= 1 && newQuantity <= 20) {
            // Max 20 items
            this.quantity = newQuantity;
            this.updateCalculations();
            this.animateChanges();

            // Track interaction for analytics
            if (typeof gtag !== 'undefined') {
              gtag('event', 'impact_calculator_interaction', {
                quantity: this.quantity,
                total_impact_value: this.calculateTotalImpact(),
              });
            }
          }
        }

        updateCalculations() {
          // Calculate financial amounts
          const totalPrice = this.quantity * this.pricePerItem;
          const donationAmount = totalPrice * this.donationPercentage;

          // Full donation applied to men's health on this page
          const mensDonation = donationAmount;

          // Calculate specific impacts based on research data
          const impacts = {
            // Men's mental health impacts
            menSupport: Math.floor(mensDonation / this.costStructure.mensHealth.crisisSupport),
            menEducation: Math.floor(
              mensDonation / this.costStructure.mensHealth.educationalMaterials
            ),
            menDigital: Math.floor(mensDonation / this.costStructure.mensHealth.digitalResources),
            menAwareness: Math.floor(
              mensDonation / this.costStructure.mensHealth.awarenessOutreach
            ),
          };

          // Update financial display
          if (this.currentQtyEl) this.currentQtyEl.textContent = this.quantity;
          if (this.totalPriceEl) this.totalPriceEl.textContent = `$${totalPrice} AUD`;
          if (this.donationAmountEl)
            this.donationAmountEl.textContent = `$${donationAmount.toFixed(2)} AUD`;

          // Update men's impacts
          if (this.menSupportEl) this.menSupportEl.textContent = `${impacts.menSupport} people`;
          if (this.menEducationEl)
            this.menEducationEl.textContent = `${impacts.menEducation} packages`;
          if (this.menDigitalEl) this.menDigitalEl.textContent = `${impacts.menDigital} sessions`;
          if (this.menAwarenessEl)
            this.menAwarenessEl.textContent = `${impacts.menAwareness} people`;

          // Calculate and update summary totals (men's metrics only)
          const totalSupport = impacts.menSupport;
          const totalEducation = impacts.menEducation;
          const totalResources = impacts.menDigital;
          const totalAwareness = impacts.menAwareness;
          const totalLives = totalSupport + Math.floor(totalAwareness / 10); // Conservative estimate

          if (this.totalSupportEl) this.totalSupportEl.textContent = totalSupport;
          if (this.totalEducationEl) this.totalEducationEl.textContent = totalEducation;
          if (this.totalResourcesEl) this.totalResourcesEl.textContent = totalResources;
          if (this.totalAwarenessEl) this.totalAwarenessEl.textContent = totalAwareness;
          if (this.totalLivesEl) this.totalLivesEl.textContent = totalLives;
        }

        calculateTotalImpact() {
          const totalPrice = this.quantity * this.pricePerItem;
          const donationAmount = totalPrice * this.donationPercentage;
          return donationAmount;
        }

        animateChanges() {
          // Add subtle scaling animation to updated numbers
          const elementsToAnimate = [
            this.totalPriceEl,
            this.donationAmountEl,
            this.menSupportEl,
            this.menEducationEl,
            this.menDigitalEl,
            this.menAwarenessEl,
            this.womenHealthEl,
            this.womenTrainingEl,
            this.womenResearchEl,
            this.womenOutreachEl,
            this.totalLivesEl,
          ];

          elementsToAnimate.forEach((el) => {
            if (el) {
              el.style.transform = 'scale(1.05)';
              el.style.transition = 'transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
              el.style.color = '#D4AF37'; // Gold highlight

              setTimeout(() => {
                el.style.transform = 'scale(1)';
                el.style.color = ''; // Reset color
              }, 300);
            }
          });
        }

        // Method to update trust signals based on impact
        updateTrustSignals() {
          // Update the main product page trust signals to reflect impact focus
          const trustSignalsSection = document.querySelector('.trust-signals');
          if (trustSignalsSection) {
            const reviewsLink = trustSignalsSection.querySelector('a[href="#testimonials"]');
            if (reviewsLink) {
              reviewsLink.href = '#impact-heading';
              reviewsLink.textContent = 'See your impact';
            }
          }
        }
      }

      // Bundle Selection Logic
      let selectedBundle = null;
      const bundlePricing = {
        3: { original: 150, sale: 135, savings: 15 },
        5: { original: 250, sale: 200, savings: 50 },
        7: { original: 350, sale: 280, savings: 70 },
        12: { original: 600, sale: 450, savings: 150 },
      };

      function initializeBundles() {
        const bundleOptions = document.querySelectorAll('.bundle-option');
        bundleOptions.forEach((option) => {
          option.addEventListener('click', () => {
            // Remove previous selection
            bundleOptions.forEach((opt) => {
              opt.classList.remove('border-black', 'bg-black/5');
              opt.classList.add('border-gray-200');
            });

            // Select current bundle
            option.classList.remove('border-gray-200', 'hover:border-gold');
            option.classList.add('border-black', 'bg-black/5');

            const bundleSize = parseInt(option.dataset.bundle);
            selectedBundle = bundleSize;

            // Update add to cart button
            updateAddToCartButton(bundleSize);
          });
        });
      }

      function updateAddToCartButton(bundleSize) {
        const addToCartBtn = document.getElementById('addToCartBtn');
        const buttonText = addToCartBtn.querySelector('.button-text');
        const pricing = bundlePricing[bundleSize];

        if (bundleSize) {
          buttonText.textContent = `ADD ${bundleSize}-PACK - $${pricing.sale}`;
          addToCartBtn.setAttribute(
            'aria-label',
            `Add ${bundleSize}-day bundle to cart for $${pricing.sale}`
          );
        } else {
          buttonText.textContent = 'ADD TO CART';
          addToCartBtn.setAttribute('aria-label', 'Add Essential Boxer Brief to cart');
        }
      }

      // Initialize the calculator when DOM is loaded
      document.addEventListener('DOMContentLoaded', () => {
        // Show 360° video first on load
        if (typeof changeTo360Video === 'function') {
          changeTo360Video();
        }

        // Initialize bundles
        initializeBundles();

        // Only initialize if impact calculator elements exist
        if (document.getElementById('currentQty')) {
          const calculator = new ResearchBasedImpactCalculator();
          calculator.updateTrustSignals();

          // Track calculator page view
          if (typeof gtag !== 'undefined') {
            gtag('event', 'impact_calculator_view', {
              page_title: 'Product Impact Calculator',
              page_location: window.location.href,
            });
          }
        }
      });
    </script>

    <!-- Footer -->
    <footer class="bg-black text-white py-10 footer-textured">
      <div class="max-w-7xl mx-auto px-6 lg:px-8 grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- Brand -->
        <div class="col-span-1 flex flex-col items-start">
          <h4 class="font-heading text-2xl tracking-luxury mb-4">CABANA</h4>
          <p class="text-sm text-gray-400">Quiet refinement for body and earth.</p>
        </div>

        <!-- Customer Care -->
        <div>
          <h3 class="text-white font-semibold mb-4">Customer Care</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="/shipping-policy.html" class="hover:text-gold">Shipping Policy</a></li>
            <li><a href="/return-policy.html" class="hover:text-gold">Return Policy</a></li>
            <li><a href="/privacy-policy.html" class="hover:text-gold">Privacy Policy</a></li>
            <li><a href="/terms-of-service.html" class="hover:text-gold">Terms of Service</a></li>
          </ul>
        </div>

        <!-- About -->
        <div>
          <h3 class="text-white font-semibold mb-4">About</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="/about.html" class="hover:text-gold">Our Story</a></li>
            <li><a href="/legal/index.html" class="hover:text-gold">Legal & Policies</a></li>
            <li><a href="/contact.html" class="hover:text-gold">Contact Us</a></li>
          </ul>
        </div>

        <!-- Social -->
        <div>
          <h3 class="text-white font-semibold mb-4">Follow Us</h3>
          <div class="flex space-x-4">
            <a
              href="https://www.instagram.com/cabana.collections/"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Instagram"
            >
              <svg class="h-5 w-5 hover:text-gold" fill="currentColor" viewBox="0 0 24 24">
                <path
                  d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5a4.25 4.25 0 0 0 4.25-4.25v-8.5A4.25 4.25 0 0 0 16.25 3.5h-8.5zm8 1.75a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5zM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 1.5a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7z"
                />
              </svg>
            </a>
            <!-- Removed Facebook link per request -->
          </div>
        </div>
      </div>

      <!-- Bottom note -->
      <div class="mt-10 border-t border-gray-800 pt-6 text-center text-xs text-gray-500">
        &copy; 2025 Cabana Collections. All rights reserved.
        <p class="mt-1">ABN 91302503433</p>
      </div>
    </footer>

    <!-- Mobile Sticky CTA Bar -->
    <div
      id="mobileStickyBar"
      class="mobile-sticky-cta fixed bottom-0 left-0 right-0 bg-white border-t shadow-2xl p-4 md:hidden z-50 transform translate-y-full transition-transform duration-300"
    >
      <div class="flex items-center gap-4">
        <!-- Product Info -->
        <div class="flex-1">
          <div class="text-lg font-medium text-black">$50 AUD</div>
          <div class="text-sm text-gray-500">Essential Boxer Brief</div>
        </div>

        <!-- Size Display -->
        <div class="text-center">
          <div class="text-xs text-gray-500 uppercase tracking-wider">Size</div>
          <div class="text-sm font-medium" id="mobileSelectedSize">M</div>
        </div>

        <!-- Add to Cart Button -->
        <button
          id="mobileAddToCart"
          class="bg-black text-white px-6 py-3 rounded-lg font-medium min-w-[100px] transition-all duration-300 hover:bg-gray-900 hover:scale-[1.02] hover:shadow-lg active:scale-95"
        >
          <span class="mobile-button-text">Add to Cart</span>
          <span class="mobile-loading-text hidden">
            <span
              class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"
            ></span>
          </span>
        </button>

        <!-- Impact Anchor on mobile sticky bar -->
        <a
          href="#impact-heading"
          id="impactAnchorMobile"
          class="ml-2 inline-flex items-center text-xs tracking-wider px-3 py-2 rounded-full border border-gray-300 text-gray-700 pill-shimmer"
        >
          Your Impact
        </a>
      </div>

      <!-- Progress bar for free shipping -->
      <div class="mt-3">
        <div class="flex justify-between text-xs text-gray-500 mb-1">
          <span>Free shipping progress</span>
          <span>$50 / $200</span>
        </div>
        <div class="bg-gray-200 rounded-full h-1.5">
          <div
            class="bg-gradient-to-r from-gold to-yellow-400 h-1.5 rounded-full transition-all duration-500 w-1/4"
          ></div>
        </div>
        <div class="text-xs text-gray-500 mt-1">Add $150 more for free shipping</div>
      </div>
    </div>
  </body>
</html>
